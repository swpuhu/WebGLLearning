<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <canvas id="canvas" width="640" height="360"></canvas>
</body>
<script type="module">
    import util from './util.js';
    const canvas = document.getElementById('canvas');
    const gl = canvas.getContext('webgl');
    const vertexShader = `
        attribute vec4 a_position;
        void main () {
            gl_Position = a_position;
        }
    `
    const fragmentShader = `
        precision mediump float;
        uniform vec2 u_resolution;
        void main () {
            vec2 v_texCoord = gl_FragCoord.xy / u_resolution;
            float f =  1. - smoothstep(0.00, 0.05, abs(v_texCoord.x - 0.5));
            // f = exp(-f);
            gl_FragColor = vec4(f, f, f, 1.0);
        }
    `
    const program = util.initWebGL(gl, vertexShader, fragmentShader);
    gl.useProgram(program);

    let points = new Float32Array([
        -1.0, -1.0, 
        1.0, -1.0,
        1.0, 1.0,
        1.0, 1.0,
        -1.0, 1.0,
        -1.0, -1.0
    ]);
    const f32size = Float32Array.BYTES_PER_ELEMENT;
    let buffer = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
    gl.bufferData(gl.ARRAY_BUFFER, points, gl.STATIC_DRAW);

    let a_position = gl.getAttribLocation(program, 'a_position');
    gl.enableVertexAttribArray(a_position);
    gl.vertexAttribPointer(a_position, 2, gl.FLOAT, false, f32size * 2, 0);

    let u_resolution = gl.getUniformLocation(program, 'u_resolution');
    gl.uniform2f(u_resolution, canvas.width, canvas.height);

    gl.drawArrays(gl.TRIANGLES, 0, 6);

</script>
</html>